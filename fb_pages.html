function saveData() {
  const rows = [...tbody.querySelectorAll("tr")];
  const payload = rows.map(row => {
    const brand = row.querySelector("img").alt;
    const oldVal = Number(row.querySelector(".old-val").textContent);
    const newVal = Number(row.querySelector(".new-val").value || 0);
    return { brand, new: newVal, diff: newVal - oldVal };
  });

  // Show overlay and disable button
  setSaving(true);

  // Safety timeout: in case fetch hangs
  const saveTimeout = setTimeout(() => {
    setSaving(false);
    showBanner(errorBanner, "Save timed out", 5000);
  }, 10000); // 10 seconds

  fetch(WEB_APP_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  })
  .then(res => res.json())
  .then(data => {
    clearTimeout(saveTimeout);
    if (data.status === "success") {
      showBanner(successBanner, "Saved successfully!", 3000);
      loadOldValues(); // Auto reload old values
    } else {
      showBanner(errorBanner, "Error saving: " + data.message, 5000);
    }
  })
  .catch(err => {
    clearTimeout(saveTimeout);
    showBanner(errorBanner, "Network error: " + err.message, 5000);
  })
  .finally(() => setSaving(false));
}
